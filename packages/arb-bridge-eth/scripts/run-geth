#!/bin/bash

echo arbitrum > password.txt
geth --datadir data init geth/ethbridge.json
cp geth/keystore/* data/keystore

# run in background
geth --datadir data --rpc --rpcaddr 'localhost' --rpcport 7545 --rpcapi 'personal,db,eth,net,web3,txpool,miner' --allow-insecure-unlock --unlock 0x81183c9c61bdf79db7330bbcda47be30c0a85064 --password ./password.txt --mine &>geth.out &

# wait until service is up
while ! nc -z localhost 7545; do sleep 2; done; \
echo "Finished waiting for geth on localhost:7545..."
echo "node output at geth.out"

# # kill service
# kill $(lsof -t -i:7545)

yarn migrate:geth

